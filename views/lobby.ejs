<!DOCTYPE html>
<html>
<head>
    <title>記數簿 Lobby</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container py-5">
    <h1 class="text-center mb-4">📂 我的記數簿</h1>
    
    <div class="row g-3 justify-content-center">
        <% if (activities.length === 0) { %>
            <div class="col-12 text-center text-muted">
                暫時未有活動，請在下方建立一個！
            </div>
        <% } %>

        <% activities.forEach(act => { %>
            <div class="col-12 col-md-6 col-lg-4">
                <a href="/activity/<%= act.id %>" class="text-decoration-none">
                    <div class="card shadow-sm hover-shadow h-100">
                        <div class="card-body text-center">
                            <h3 class="card-title text-primary"><%= act.name %></h3>
                            <p class="badge bg-secondary"><%= act.type === 'split' ? '夾錢模式' : '計局模式' %></p>
                            <% if(act.type !== 'split') { %>
                                <p class="text-muted mb-0">每局: $<%= parseFloat(act.cost_per_game).toFixed(2) %></p>
                            <% } %>
                        </div>
                    </div>
                </a>
            </div>
        <% }) %>
    </div>

    <hr class="my-5">

    <div class="text-center mb-3">
        <button class="btn btn-lg btn-outline-success" type="button" data-bs-toggle="collapse" data-bs-target="#createActivityBox">
            ➕ 建立新活動
        </button>
    </div>

    <div class="collapse" id="createActivityBox">
        <div class="card mx-auto" style="max-width: 500px;">
            <div class="card-body">
                <h5 class="card-title text-center">新活動資料</h5>
                <form action="/create-activity" method="POST">
                    <div class="mb-3">
                        <label class="form-label">活動名稱</label>
                        <input type="text" name="name" class="form-control" placeholder="例如: 星期五保齡 / Pickleball" required>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">計費模式</label>
                        <select name="type" class="form-select" id="activityType">
                            <option value="split">Pickleball / 食飯 (輸入總數 ÷ 人頭)</option>
                            <option value="bowling" selected>保齡球 (按局數計 x 單價)</option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">預設每局金額 (只適用於保齡)</label>
                        <input type="number" step="0.01" name="cost" class="form-control" value="5.65">
                    </div>
                    <button class="btn btn-success w-100">立即建立</button>
                </form>
            </div>
        </div>
    </div>
    
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>