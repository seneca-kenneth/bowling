<!DOCTYPE html>
<html>
<head>
    <title>è¨˜æ•¸ç°¿ Lobby</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#f8f9fa">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .hover-shadow:hover { transform: translateY(-3px); box-shadow: 0 .5rem 1rem rgba(0,0,0,.15)!important; transition: all .2s; }
    </style>
</head>
<body class="bg-light">
<div class="container py-5">
    
    <div class="d-flex justify-content-end mb-2">
        <button class="btn btn-sm btn-outline-secondary" onclick="toggleLanguage()">ğŸŒ <span id="langLabel">EN</span></button>
    </div>

    <h1 class="text-center mb-4"><span data-i18n="title">ğŸ“‚ æˆ‘çš„è¨˜æ•¸ç°¿</span></h1>
    
    <div class="row g-3 justify-content-center">
        <% if (activities.length === 0) { %>
            <div class="col-12 text-center text-muted" data-i18n="no_activity">
                æš«æ™‚æœªæœ‰æ´»å‹•ï¼Œè«‹åœ¨ä¸‹æ–¹å»ºç«‹ä¸€å€‹ï¼
            </div>
        <% } %>

        <% activities.forEach(act => { %>
            <div class="col-12 col-md-6 col-lg-4">
                <a href="/activity/<%= act.id %>" class="text-decoration-none">
                    <div class="card shadow-sm hover-shadow h-100">
                        <div class="card-body text-center">
                            <h3 class="card-title text-primary"><%= act.name %></h3>
                            <p class="badge bg-secondary">
                                <% if(act.type === 'split') { %>
                                    <span data-i18n="mode_split">å¤¾éŒ¢æ¨¡å¼</span>
                                <% } else { %>
                                    <span data-i18n="mode_bowling">è¨ˆå±€æ¨¡å¼</span>
                                <% } %>
                            </p>
                            <% if(act.type !== 'split') { %>
                                <p class="text-muted mb-0"><span data-i18n="per_game">æ¯å±€</span>: $<%= parseFloat(act.cost_per_game).toFixed(2) %></p>
                            <% } %>
                        </div>
                    </div>
                </a>
            </div>
        <% }) %>
    </div>

    <hr class="my-5">

    <div class="text-center mb-3">
        <button class="btn btn-lg btn-outline-success" type="button" data-bs-toggle="collapse" data-bs-target="#createActivityBox">
            â• <span data-i18n="btn_create_new">å»ºç«‹æ–°æ´»å‹•</span>
        </button>
    </div>

    <div class="collapse" id="createActivityBox">
        <div class="card mx-auto" style="max-width: 500px;">
            <div class="card-body">
                <h5 class="card-title text-center" data-i18n="new_activity_title">æ–°æ´»å‹•è³‡æ–™</h5>
                <form action="/create-activity" method="POST">
                    <div class="mb-3">
                        <label class="form-label" data-i18n="label_name">æ´»å‹•åç¨±</label>
                        <input type="text" name="name" class="form-control" placeholder="Activity Name" required>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label" data-i18n="label_type">è¨ˆè²»æ¨¡å¼</label>
                        <select name="type" class="form-select" id="activityType">
                            <option value="split" data-i18n="opt_split">Pickleball / é£Ÿé£¯ (è¼¸å…¥ç¸½æ•¸ Ã· äººé ­)</option>
                            <option value="bowling" selected data-i18n="opt_bowling">ä¿é½¡çƒ (æŒ‰å±€æ•¸è¨ˆ x å–®åƒ¹)</option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label class="form-label" data-i18n="label_default_cost">é è¨­æ¯å±€é‡‘é¡ (åªé©ç”¨æ–¼ä¿é½¡)</label>
                        <input type="number" step="0.01" name="cost" class="form-control" value="5.65">
                    </div>
                    <button class="btn btn-success w-100" data-i18n="btn_create_submit">ç«‹å³å»ºç«‹</button>
                </form>
            </div>
        </div>
    </div>
    
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    const translations = {
        zh: {
            title: "ğŸ“‚ æˆ‘çš„è¨˜æ•¸ç°¿",
            no_activity: "æš«æ™‚æœªæœ‰æ´»å‹•ï¼Œè«‹åœ¨ä¸‹æ–¹å»ºç«‹ä¸€å€‹ï¼",
            mode_split: "å¤¾éŒ¢æ¨¡å¼",
            mode_bowling: "è¨ˆå±€æ¨¡å¼",
            per_game: "æ¯å±€",
            btn_create_new: "å»ºç«‹æ–°æ´»å‹•",
            new_activity_title: "æ–°æ´»å‹•è³‡æ–™",
            label_name: "æ´»å‹•åç¨±",
            label_type: "è¨ˆè²»æ¨¡å¼",
            opt_split: "Pickleball / é£Ÿé£¯ (è¼¸å…¥ç¸½æ•¸ Ã· äººé ­)",
            opt_bowling: "ä¿é½¡çƒ (æŒ‰å±€æ•¸è¨ˆ x å–®åƒ¹)",
            label_default_cost: "é è¨­æ¯å±€é‡‘é¡ (åªé©ç”¨æ–¼ä¿é½¡)",
            btn_create_submit: "ç«‹å³å»ºç«‹"
        },
        en: {
            title: "ğŸ“‚ My Scorebook",
            no_activity: "No activities yet. Create one below!",
            mode_split: "Split Mode",
            mode_bowling: "Game Mode",
            per_game: "Per Game",
            btn_create_new: "New Activity",
            new_activity_title: "Activity Info",
            label_name: "Activity Name",
            label_type: "Billing Type",
            opt_split: "Pickleball / Split Bill (Total Ã· People)",
            opt_bowling: "Bowling (Games x Cost)",
            label_default_cost: "Default Cost Per Game (Bowling only)",
            btn_create_submit: "Create Now"
        }
    };

    let currentLang = localStorage.getItem('appLang') || 'zh';

    function applyLanguage() {
        const langData = translations[currentLang];
        document.querySelectorAll('[data-i18n]').forEach(el => {
            const key = el.getAttribute('data-i18n');
            if (langData[key]) el.innerText = langData[key];
        });
        document.getElementById('langLabel').innerText = currentLang === 'zh' ? 'EN' : 'ä¸­';
    }

    function toggleLanguage() {
        currentLang = currentLang === 'zh' ? 'en' : 'zh';
        localStorage.setItem('appLang', currentLang);
        applyLanguage();
    }

    applyLanguage();
</script>
</body>
</html>